<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 550" font-family="Arial, sans-serif">
  <defs>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#3F8999"/>
    </marker>
  </defs>

  <rect width="960" height="550" fill="white"/>

  <!-- Title -->
  <text x="480" y="34" text-anchor="middle" font-size="21" font-weight="bold" fill="#326F95">BPMN Linting Overview</text>

  <!-- ===== SERVICE PIPELINE ===== -->

  <!-- Input -->
  <rect x="20" y="50" width="128" height="62" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="84" y="73" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">Input</text>
  <text x="84" y="89" text-anchor="middle" font-size="10" fill="#555">BPMN Files (.bpmn)</text>
  <text x="84" y="104" text-anchor="middle" font-size="10" fill="#555">Plugin Context</text>
  <line x1="148" y1="81" x2="165" y2="81" stroke="#3F8999" stroke-width="2" marker-end="url(#arr)"/>

  <!-- BpmnLintingService -->
  <rect x="165" y="50" width="183" height="62" rx="5" fill="#326F95"/>
  <text x="256" y="76" text-anchor="middle" font-size="12" font-weight="bold" fill="white">BpmnLintingService</text>
  <text x="256" y="95" text-anchor="middle" font-size="10" fill="white">extends AbstractResourceLintingService</text>
  <line x1="348" y1="81" x2="365" y2="81" stroke="#3F8999" stroke-width="2" marker-end="url(#arr)"/>

  <!-- BpmnLinter -->
  <rect x="365" y="50" width="150" height="62" rx="5" fill="#326F95"/>
  <text x="440" y="76" text-anchor="middle" font-size="12" font-weight="bold" fill="white">BpmnLinter</text>
  <text x="440" y="95" text-anchor="middle" font-size="10" fill="white">Parses .bpmn files</text>
  <line x1="515" y1="81" x2="532" y2="81" stroke="#3F8999" stroke-width="2" marker-end="url(#arr)"/>

  <!-- BpmnModelLinter -->
  <rect x="532" y="50" width="195" height="62" rx="5" fill="#3F8999"/>
  <text x="629" y="76" text-anchor="middle" font-size="12" font-weight="bold" fill="white">BpmnModelLinter</text>
  <text x="629" y="95" text-anchor="middle" font-size="10" fill="white">Orchestrates model validation</text>

  <!-- Connector: BpmnModelLinter to sub-linters -->
  <line x1="629" y1="112" x2="629" y2="127" stroke="#3F8999" stroke-width="1.5"/>
  <line x1="480" y1="127" x2="629" y2="127" stroke="#3F8999" stroke-width="1.5"/>
  <line x1="480" y1="127" x2="480" y2="153" stroke="#3F8999" stroke-width="1.5" marker-end="url(#arr)"/>
  <text x="491" y="143" font-size="10" fill="#999" font-style="italic">Delegates to:</text>

  <!-- ===== ROW 1: 4 Sub-linters (y=156, h=110, w=200, gap=13) ===== -->
  <!-- x: 60, 273, 486, 699 -->

  <!-- BpmnProcessLinter -->
  <rect x="60" y="156" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="160" y="175" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnProcessLinter</text>
  <line x1="60" y1="181" x2="260" y2="181" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="70" y="196" font-size="10" fill="#555">&#8226; Process ID pattern</text>
  <text x="70" y="211" font-size="10" fill="#555">&#8226; Exactly one process per file</text>
  <text x="70" y="226" font-size="10" fill="#555">&#8226; Executable flag</text>
  <text x="70" y="241" font-size="10" fill="#555">&#8226; History time to live</text>
  <text x="70" y="256" font-size="10" fill="#555">&#8226; Process name</text>

  <!-- BpmnTaskLinter -->
  <rect x="273" y="156" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="373" y="175" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnTaskLinter</text>
  <line x1="273" y1="181" x2="473" y2="181" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="283" y="196" font-size="10" fill="#555">&#8226; Service Tasks (class, interface)</text>
  <text x="283" y="211" font-size="10" fill="#555">&#8226; User Tasks (formKey, Questionnaire)</text>
  <text x="283" y="226" font-size="10" fill="#555">&#8226; Send Tasks (FHIR references)</text>
  <text x="283" y="241" font-size="10" fill="#555">&#8226; Receive Tasks (message def.)</text>

  <!-- BpmnEventLinter -->
  <rect x="486" y="156" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="586" y="175" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnEventLinter</text>
  <line x1="486" y1="181" x2="686" y2="181" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="496" y="196" font-size="10" fill="#555">&#8226; Start Events (message, timer)</text>
  <text x="496" y="211" font-size="10" fill="#555">&#8226; End Events (message)</text>
  <text x="496" y="226" font-size="10" fill="#555">&#8226; Intermediate Events</text>
  <text x="496" y="241" font-size="10" fill="#555">&#8226; Boundary Events (error, signal)</text>

  <!-- BpmnGatewayAndFlowLinter -->
  <rect x="699" y="156" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="799" y="170" text-anchor="middle" font-size="10" font-weight="bold" fill="#326F95">BpmnGateway</text>
  <text x="799" y="183" text-anchor="middle" font-size="10" font-weight="bold" fill="#326F95">AndFlowLinter</text>
  <line x1="699" y1="189" x2="899" y2="189" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="709" y="204" font-size="10" fill="#555">&#8226; Exclusive/Inclusive gateways</text>
  <text x="709" y="219" font-size="10" fill="#555">&#8226; Event-based gateways</text>
  <text x="709" y="234" font-size="10" fill="#555">&#8226; Sequence flow naming</text>
  <text x="709" y="249" font-size="10" fill="#555">&#8226; Condition expressions</text>

  <!-- ===== ROW 2: 3 Sub-linters (y=280, h=110, w=200, gap=50) ===== -->
  <!-- x: 130, 380, 630 -->

  <!-- BpmnSubProcessLinter -->
  <rect x="130" y="280" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="230" y="299" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnSubProcessLinter</text>
  <line x1="130" y1="305" x2="330" y2="305" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="140" y="320" font-size="10" fill="#555">&#8226; Multi-instance subprocesses</text>
  <text x="140" y="335" font-size="10" fill="#555">&#8226; asyncBefore configuration</text>

  <!-- BpmnFieldInjectionLinter -->
  <rect x="380" y="280" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="480" y="299" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnFieldInjectionLinter</text>
  <line x1="380" y1="305" x2="580" y2="305" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="390" y="320" font-size="10" fill="#555">&#8226; Profile field validation</text>
  <text x="390" y="335" font-size="10" fill="#555">&#8226; messageName field</text>
  <text x="390" y="350" font-size="10" fill="#555">&#8226; instantiatesCanonical</text>
  <text x="390" y="365" font-size="10" fill="#555">&#8226; FHIR cross-references</text>

  <!-- BpmnElementLinter -->
  <rect x="630" y="280" width="200" height="110" rx="5" fill="white" stroke="#54AEA0" stroke-width="1.5"/>
  <text x="730" y="299" text-anchor="middle" font-size="11" font-weight="bold" fill="#326F95">BpmnElementLinter</text>
  <line x1="630" y1="305" x2="830" y2="305" stroke="#54AEA0" stroke-width="0.8"/>
  <text x="640" y="320" font-size="10" fill="#555">&#8226; Messages (BpmnMessageLinter)</text>
  <text x="640" y="335" font-size="10" fill="#555">&#8226; Listeners (BpmnListenerLinter)</text>
  <text x="640" y="350" font-size="10" fill="#555">&#8226; Timers (BpmnTimerLinter)</text>

  <!-- Arrow to LintingResult -->
  <line x1="480" y1="390" x2="480" y2="411" stroke="#3F8999" stroke-width="2" marker-end="url(#arr)"/>

  <!-- LintingResult -->
  <rect x="175" y="413" width="610" height="50" rx="5" fill="#3F8999"/>
  <text x="480" y="433" text-anchor="middle" font-size="13" font-weight="bold" fill="white">LintingResult</text>
  <text x="480" y="452" text-anchor="middle" font-size="11" fill="white">BpmnElementLintItem | ~99 Checks | ERROR | WARN | INFO | SUCCESS</text>

  <!-- ===== SHARED UTILITIES ===== -->
  <text x="20" y="481" font-size="11" fill="#777">Shared Utilities:</text>

  <!-- 4 boxes: w=175, gap=15, total=745, margin=107 -->
  <!-- x: 107, 297, 487, 677 -->

  <rect x="107" y="487" width="175" height="48" rx="4" fill="white" stroke="#63C7A6" stroke-width="1.5"/>
  <text x="194" y="506" text-anchor="middle" font-size="11" fill="#326F95">FhirResourceLocator</text>
  <text x="194" y="523" text-anchor="middle" font-size="10" fill="#555">Cross-reference validation</text>

  <rect x="297" y="487" width="175" height="48" rx="4" fill="white" stroke="#63C7A6" stroke-width="1.5"/>
  <text x="384" y="506" text-anchor="middle" font-size="11" fill="#326F95">LintingOutput</text>
  <text x="384" y="523" text-anchor="middle" font-size="10" fill="#555">Collects lint items</text>

  <rect x="487" y="487" width="175" height="48" rx="4" fill="white" stroke="#63C7A6" stroke-width="1.5"/>
  <text x="574" y="506" text-anchor="middle" font-size="11" fill="#326F95">AbstractLintingService</text>
  <text x="574" y="523" text-anchor="middle" font-size="10" fill="#555">Template method base</text>

  <rect x="677" y="487" width="175" height="48" rx="4" fill="white" stroke="#63C7A6" stroke-width="1.5"/>
  <text x="764" y="506" text-anchor="middle" font-size="11" fill="#326F95">ConcurrentCache</text>
  <text x="764" y="523" text-anchor="middle" font-size="10" fill="#555">Thread-safe caching</text>
</svg>
